<!DOCTYPE html>
<html lang="en">
<head>
<meta charset="UTF-8">
<meta name="viewport" content="width=device-width, initial-scale=1.0">
<link rel="icon" href="/favicon.svg" type="image/svg+xml">
<link rel="stylesheet" href="/styles.css">
<title>OAS â€” OpenClaw Auto Sprint</title>
</head>
<body>

<div class="header">
  <h1><span>OAS</span> â€” OpenClaw Auto Sprint</h1>
  <div style="text-align:right">
    <div id="clock" style="color:#8b949e;font-size:13px"></div>
    <div id="last-pulse" style="color:#484f58;font-size:11px"></div>
  </div>
</div>

<div class="stats" id="stats"></div>

<div class="tabs">
  <button class="tab active" data-tab="board">ğŸ“‹ Board</button>
  <button class="tab" data-tab="runs">âš¡ Runs</button>
  <button class="tab" data-tab="log">ğŸ“‹ Log</button>
  <button class="tab" data-tab="docs">ğŸ“– Docs</button>
  <button class="tab" data-tab="ideas">ğŸ’¡ Ideas</button>
  <button class="tab" data-tab="tools">ğŸ§° Tools</button>
  <button class="tab" data-tab="brain">ğŸ§¬ Cortex</button>
  <button class="tab" data-tab="schedule">ğŸ“… Schedule</button>
</div>

<!-- Tab: Board -->
<div class="tab-content active" id="tab-board">
  <div class="filters">
    <button class="filter-btn active" id="filter-all" onclick="setFilter('all')">All</button>
    <button class="filter-btn" id="filter-human" onclick="setFilter('human')">ğŸ‘¤ <span class="human-name-label">Human</span></button>
    <button class="filter-btn" id="filter-agent" onclick="setFilter('agent')">ğŸ¤– <span class="agent-name-label">Agent</span></button>
  </div>
  <div class="search-bar">
    <input type="text" id="search-input" placeholder="ğŸ” Search by #ID, title, or memory..." onkeyup="if(event.key==='Enter')searchMemory()">
    <button onclick="searchMemory()">Search</button>
  </div>
  <div id="search-results"></div>

  <div class="filters-bar">
    <span class="filter-label">Filters:</span>
    <select id="filter-priority" onchange="applyAdvancedFilters()">
      <option value="">All priorities</option>
      <option value="high">ğŸ”´ High</option>
      <option value="normal">Normal</option>
      <option value="low">Low</option>
    </select>
    <select id="filter-type" onchange="applyAdvancedFilters()">
      <option value="">All types</option>
      <option value="dev">Development</option>
      <option value="content">Content</option>
      <option value="ops">Operations</option>
      <option value="security">Security</option>
      <option value="research">Research</option>
      <option value="dashboard">Dashboard</option>
      <option value="other">Other</option>
    </select>
    <select id="filter-status" onchange="applyAdvancedFilters()">
      <option value="">All statuses</option>
      <option value="todo">ğŸ“‹ Todo</option>
      <option value="doing">âš¡ Doing</option>
      <option value="done">âœ… Done</option>
      <option value="routine">ğŸ”„ Routine</option>
    </select>
    <select id="filter-ticket-type" onchange="applyAdvancedFilters()">
      <option value="">All types</option>
      <option value="auto">âš¡ Auto</option>
      <option value="manual">ğŸ”§ Manual</option>
    </select>
    <button class="clear-filters" onclick="clearAdvancedFilters()">Clear</button>
  </div>

  <details style="margin: 0 20px 8px;background:#161b22;border:1px solid #30363d;border-radius:8px;padding:4px 12px;">
    <summary style="cursor:pointer;color:#58a6ff;font-size:14px;font-weight:600;padding:8px 0;">â• New task</summary>
    <div class="add-form" style="margin-top:8px;">
      <div class="form-row">
        <input type="text" id="f-title" placeholder="Task title">
        <select id="f-assignee"></select>
        <select id="f-priority"><option value="normal">Normal</option><option value="high">ğŸ”´ High</option></select>
        <select id="f-ticket-type"><option value="auto">âš¡ Auto</option><option value="manual">ğŸ”§ Manual</option></select>
      </div>
      <div class="form-row">
        <textarea id="f-desc" placeholder="Description"></textarea>
      </div>
      <div class="form-row">
        <input type="text" id="f-project" placeholder="Project reference (optional)">
      </div>
      <div class="form-row">
        <label for="f-due" style="color:#8b949e;font-size:12px">ğŸ“… Due date</label>
        <input type="date" id="f-due" style="background:#161b22;color:#c9d1d9;border:1px solid #30363d;border-radius:6px;padding:6px 10px">
      </div>
      <div class="form-row">
        <input type="text" id="f-drive" placeholder="Drive link (optional)">
        <input type="text" id="f-github" placeholder="GitHub link (optional)">
        <button class="btn-add" onclick="addTask()">Create</button>
      </div>
    </div>
  </details>

  <div class="board">
    <div class="column col-todo" id="section-todo">
      <div class="column-header" onclick="toggleSection('todo')">ğŸ“‹ To Do <span id="count-todo" style="font-size:11px;color:#8b949e;font-weight:400;"></span><span class="collapse-icon" id="icon-todo">â–¼</span></div>
      <div class="cards" id="cards-todo"></div>
    </div>
    <div class="column col-doing" id="section-doing">
      <div class="column-header" onclick="toggleSection('doing')">âš¡ Doing <span id="count-doing" style="font-size:11px;color:#8b949e;font-weight:400;"></span><span class="collapse-icon" id="icon-doing">â–¼</span></div>
      <div class="cards" id="cards-doing"></div>
    </div>
    <div class="column col-done" id="section-review">
      <div class="column-header" onclick="toggleSection('review')">ğŸ‘€ Review <span id="count-review" style="font-size:11px;color:#8b949e;font-weight:400;"></span><span class="collapse-icon" id="icon-review">â–¼</span></div>
      <div class="cards" id="cards-review"></div>
    </div>
  </div>
  <div class="routine-section" style="margin:0 20px 12px;" id="section-routine">
    <div style="font-size:14px;font-weight:700;margin-bottom:8px;display:flex;align-items:center;gap:8px;color:#d29922;cursor:pointer;user-select:none;" onclick="toggleSection('routine')">ğŸ”„ Routines <span id="routine-count" style="font-size:11px;color:#8b949e;font-weight:400;"></span><span class="collapse-icon" id="icon-routine" style="font-size:10px;margin-left:auto;">â–¼</span></div>
    <div class="cards" id="cards-routine"></div>
  </div>

  <div class="closed-section">
    <details>
      <summary class="closed-toggle">âœ… Closed <span id="closed-count" style="font-size:11px;color:#8b949e;margin-left:4px;"></span></summary>
      <div class="cards" id="cards-closed" style="padding:8px 0;"></div>
    </details>
  </div>
</div>

<!-- Tab: Runs -->
<div class="tab-content" id="tab-runs">
  <div class="section">
    <div class="section-title">âš¡ Worker Runs <span class="count" id="runs-count"></span></div>
    <div id="runs-stats" style="display:flex;gap:8px;margin-bottom:12px;flex-wrap:wrap;"></div>
    <div id="runs-container" style="overflow-x:auto;">
      <table style="width:100%;font-size:12px;border-collapse:collapse;background:#161b22;border:1px solid #30363d;border-radius:8px;">
        <thead>
          <tr style="border-bottom:1px solid #30363d;">
            <th style="text-align:left;padding:8px;color:#8b949e;">Time</th>
            <th style="text-align:left;padding:8px;color:#8b949e;">Worker</th>
            <th style="text-align:left;padding:8px;color:#8b949e;">Ticket</th>
            <th style="text-align:left;padding:8px;color:#8b949e;">Model</th>
            <th style="text-align:right;padding:8px;color:#8b949e;">Tokens In</th>
            <th style="text-align:right;padding:8px;color:#8b949e;">Tokens Out</th>
            <th style="text-align:right;padding:8px;color:#8b949e;">Cost</th>
            <th style="text-align:right;padding:8px;color:#8b949e;">Duration</th>
            <th style="text-align:center;padding:8px;color:#8b949e;">Status</th>
          </tr>
        </thead>
        <tbody id="runs-tbody"></tbody>
      </table>
    </div>
  </div>
</div>

<!-- Tab: Schedule -->
<div class="tab-content" id="tab-schedule">
  <iframe src="/calendar.html" style="width:100%;height:calc(100vh - 140px);border:none;border-radius:8px;"></iframe>
</div>

<!-- Tab: Activity Log -->
<div class="tab-content" id="tab-log">
  <div style="padding: 12px 0;">
    <div class="activity-log" id="activity-log" style="max-height:500px;"></div>
  </div>
</div>

<!-- Tab: Docs -->
<div class="tab-content" id="tab-docs">
  <div class="section" style="max-width:800px;">

    <!-- Quickstart (hardcoded, always at top) -->
    <div class="doc-section" style="background:#161b22;border:1px solid #30363d;border-radius:8px;margin-bottom:16px;">
      <div class="doc-header" style="background:#1a1f27;border-bottom:1px solid #30363d;padding:12px 16px;border-radius:8px 8px 0 0;cursor:pointer;display:flex;align-items:center;justify-content:space-between;" onclick="toggleDocSection(this)">
        <h3 style="color:#f78166;font-size:16px;margin:0;">ğŸš€ Quickstart</h3>
        <span class="collapse-indicator" style="color:#8b949e;font-size:14px;transition:transform 0.2s;">â–¼</span>
      </div>
      <div class="doc-content" style="padding:16px;font-size:13px;line-height:1.7;color:#c9d1d9;">
        <p><strong>What is this?</strong> OAS â€” OpenClaw Auto Sprint. A Kanban board where humans and agents coordinate tasks, routines, and reviews.</p>
        <p style="margin-top:8px;"><strong>Create a task:</strong> Click <span style="color:#58a6ff;">"+ New task"</span> above the board. Fill in title, assignee, priority, description, due date.</p>
        <p style="margin-top:8px;"><strong>Edit a task:</strong> Use the action buttons on each card (â–¶ Start, âœ… Done, ğŸ‘€ Approve). Click on the priority to change it. Click on the assignee badge to reassign. Click on the date to change due date.</p>
        <p style="margin-top:8px;"><strong>Comments:</strong> Click "ğŸ’¬ comments" to open, write feedback and send.</p>
        <p style="margin-top:8px;"><strong>Search:</strong> Use the search bar to find content in memory files.</p>
      </div>
    </div>

    <!-- Dynamic docs sections will be loaded here -->
    <div id="dynamic-docs-container">
      <p style="color:#8b949e;text-align:center;padding:20px;">Loading documentation...</p>
    </div>

  </div>
</div>

<!-- Tab: Brain -->
<div class="tab-content" id="tab-brain">
  <div class="section" style="max-width:900px;">
    <div id="brain-content" style="font-size:13px;line-height:1.7;color:#c9d1d9;"></div>
  </div>
</div>

<!-- Tab: Ideas -->
<div class="tab-content" id="tab-ideas">
  <div class="section">
    <div class="filters-bar">
      <span class="filter-label">Filters:</span>
      <select id="filter-idea-status" onchange="applyIdeaFilters()">
        <option value="">All statuses</option>
        <option value="idea">ğŸ’¡ Idea</option>
        <option value="explorando">ğŸ”¬ Explorando</option>
        <option value="descartada">âŒ Descartada</option>
        <option value="promovida">ğŸ¯ Promovida</option>
      </select>
      <input type="text" id="filter-idea-tag" placeholder="Filter by tag" onkeyup="if(event.key==='Enter')applyIdeaFilters()" style="background: #0d1117; border: 1px solid #30363d; color: #c9d1d9; padding: 6px 10px; border-radius: 6px; font-size: 12px; margin-left: 8px;">
      <button class="clear-filters" onclick="clearIdeaFilters()">Clear</button>
    </div>

    <details style="margin: 0 20px 8px;background:#161b22;border:1px solid #30363d;border-radius:8px;padding:4px 12px;">
      <summary style="cursor:pointer;color:#58a6ff;font-size:14px;font-weight:600;padding:8px 0;">ğŸ’¡ Nueva idea</summary>
      <div class="add-form" style="margin-top:8px;">
        <div class="form-row">
          <input type="text" id="idea-title" placeholder="TÃ­tulo de la idea">
          <input type="text" id="idea-source" placeholder="Fuente (link, persona, etc.)">
        </div>
        <div class="form-row">
          <textarea id="idea-context" placeholder="Contexto (2-3 lÃ­neas explicando la idea)" style="min-height: 60px;"></textarea>
        </div>
        <div class="form-row">
          <input type="text" id="idea-tags" placeholder="Tags (separados por comas: #ads, #mcp, #contenido)">
          <button class="btn-add" onclick="addIdea()">Crear Idea</button>
        </div>
      </div>
    </details>

    <div class="section-title">ğŸ’¡ Ideas & InspiraciÃ³n <span class="count" id="ideas-count"></span></div>
    <div class="cards" id="ideas-container">
      <!-- Ideas will be loaded here -->
    </div>
  </div>
</div>

<!-- Tab: Tools -->
<div class="tab-content" id="tab-tools">
  <div class="section" style="max-width:900px;">
    <div id="tools-content" style="font-size:13px;line-height:1.7;color:#c9d1d9;"></div>
  </div>
</div>

<script src="https://cdn.jsdelivr.net/npm/marked/marked.min.js"></script>
<script src="/js/state.js"></script>
<script src="/js/utils.js"></script>
<script src="/js/api.js"></script>
<script src="/js/board.js"></script>
<script src="/js/app.js"></script>
</body>
</html>
