<!DOCTYPE html>
<html lang="en">
<head>
<meta charset="UTF-8">
<meta name="viewport" content="width=device-width, initial-scale=1.0">
<link rel="icon" href="/favicon.svg" type="image/svg+xml">
<link rel="preconnect" href="https://fonts.googleapis.com">
<link rel="preconnect" href="https://fonts.gstatic.com" crossorigin>
<link href="https://fonts.googleapis.com/css2?family=Outfit:wght@300;400;500;600;700&family=JetBrains+Mono:wght@400;500;600&display=swap" rel="stylesheet">
<link rel="stylesheet" href="/styles.css">
<title>OAS â€” OpenClaw Auto Sprint</title>
</head>
<body>

<div class="topbar">
  <div class="topbar-left">
    <div class="topbar-icon">O</div>
    <h1><span>OAS</span> â€” OpenClaw Auto Sprint</h1>
  </div>
  <div class="topbar-right">
    <div class="topbar-meta">
      <div class="topbar-tz" id="clock"></div>
      <div class="topbar-updated" id="last-pulse"></div>
    </div>
    <div class="status-dot" title="Live"></div>
  </div>
</div>

<div class="stats-strip" id="stats"></div>

<div class="tabs">
  <button class="tab active" data-tab="board">ğŸ“‹ Board</button>
  <button class="tab" data-tab="runs">âš¡ Runs</button>
  <button class="tab" data-tab="log">ğŸ“‹ Log</button>
  <button class="tab" data-tab="docs">ğŸ“– Docs</button>
  <button class="tab" data-tab="ideas">ğŸ’¡ Ideas</button>
  <button class="tab" data-tab="tools">ğŸ§° Tools</button>
  <button class="tab" data-tab="brain">ğŸ§¬ Cortex</button>
  <button class="tab" data-tab="schedule">ğŸ“… Schedule</button>
</div>

<!-- Tab: Board -->
<div class="tab-content active" id="tab-board">
  <div class="filters">
    <button class="filter-btn active" id="filter-all" onclick="setFilter('all')">All</button>
    <button class="filter-btn" id="filter-human" onclick="setFilter('human')">ğŸ‘¤ <span class="human-name-label">Human</span></button>
    <button class="filter-btn" id="filter-agent" onclick="setFilter('agent')">ğŸ¤– <span class="agent-name-label">Agent</span></button>
  </div>
  <div class="search-bar">
    <input type="text" id="search-input" placeholder="ğŸ” Search by #ID, title, or memory..." onkeyup="if(event.key==='Enter')searchMemory()">
    <button onclick="searchMemory()">Search</button>
  </div>
  <div id="search-results"></div>

  <div class="filters-bar">
    <span class="filter-label">Filters:</span>
    <select id="filter-priority" onchange="applyAdvancedFilters()">
      <option value="">All priorities</option>
      <option value="high">ğŸ”´ High</option>
      <option value="normal">Normal</option>
      <option value="low">Low</option>
    </select>
    <select id="filter-type" onchange="applyAdvancedFilters()">
      <option value="">All types</option>
      <option value="dev">Development</option>
      <option value="content">Content</option>
      <option value="ops">Operations</option>
      <option value="security">Security</option>
      <option value="research">Research</option>
      <option value="dashboard">Dashboard</option>
      <option value="other">Other</option>
    </select>
    <select id="filter-status" onchange="applyAdvancedFilters()">
      <option value="">All statuses</option>
      <option value="todo">ğŸ“‹ Todo</option>
      <option value="doing">âš¡ Doing</option>
      <option value="done">âœ… Done</option>
      <option value="routine">ğŸ”„ Routine</option>
    </select>
    <select id="filter-ticket-type" onchange="applyAdvancedFilters()">
      <option value="">All types</option>
      <option value="auto">âš¡ Auto</option>
      <option value="manual">ğŸ”§ Manual</option>
    </select>
    <button class="clear-filters" onclick="clearAdvancedFilters()">Clear</button>
  </div>

  <details class="form-details">
    <summary>â• New task</summary>
    <div class="add-form">
      <div class="form-row">
        <input type="text" id="f-title" placeholder="Task title">
        <select id="f-assignee"></select>
        <select id="f-priority"><option value="normal">Normal</option><option value="high">ğŸ”´ High</option></select>
        <select id="f-ticket-type"><option value="auto">âš¡ Auto</option><option value="manual">ğŸ”§ Manual</option></select>
      </div>
      <div class="form-row">
        <textarea id="f-desc" placeholder="Description"></textarea>
      </div>
      <div class="form-row">
        <input type="text" id="f-project" placeholder="Project reference (optional)">
      </div>
      <div class="form-row">
        <label for="f-due" class="form-date-label">ğŸ“… Due date</label>
        <input type="date" id="f-due" class="form-date-input">
      </div>
      <div class="form-row">
        <input type="text" id="f-drive" placeholder="Drive link (optional)">
        <input type="text" id="f-github" placeholder="GitHub link (optional)">
        <button class="btn-add" onclick="addTask()">Create</button>
      </div>
    </div>
  </details>

  <div class="board">
    <div class="column col-todo" id="section-todo">
      <div class="column-header" onclick="toggleSection('todo')">ğŸ“‹ To Do <span id="count-todo" class="column-count"></span><span class="collapse-icon" id="icon-todo">â–¼</span></div>
      <div class="cards" id="cards-todo"></div>
    </div>
    <div class="column col-doing" id="section-doing">
      <div class="column-header" onclick="toggleSection('doing')">âš¡ Doing <span id="count-doing" class="column-count"></span><span class="collapse-icon" id="icon-doing">â–¼</span></div>
      <div class="cards" id="cards-doing"></div>
    </div>
    <div class="column col-done" id="section-review">
      <div class="column-header" onclick="toggleSection('review')">ğŸ‘€ Review <span id="count-review" class="column-count"></span><span class="collapse-icon" id="icon-review">â–¼</span></div>
      <div class="cards" id="cards-review"></div>
    </div>
  </div>
  <div class="routine-section" id="section-routine">
    <div class="routine-header" onclick="toggleSection('routine')">ğŸ”„ Routines <span id="routine-count" class="column-count"></span><span class="collapse-icon" id="icon-routine">â–¼</span></div>
    <div class="cards" id="cards-routine"></div>
  </div>

  <div class="closed-section">
    <details>
      <summary class="closed-toggle">âœ… Closed <span id="closed-count" class="column-count"></span></summary>
      <div class="cards" id="cards-closed"></div>
    </details>
  </div>
</div>

<!-- Tab: Runs -->
<div class="tab-content" id="tab-runs">
  <div class="section">
    <div class="section-title">âš¡ Worker Runs <span class="count" id="runs-count"></span></div>
    <div id="runs-stats" class="stats-strip"></div>
    <div id="runs-container" style="overflow-x:auto;">
      <table class="runs-table">
        <thead>
          <tr>
            <th class="text-left">Time</th>
            <th class="text-left">Worker</th>
            <th class="text-left">Ticket</th>
            <th class="text-left">Model</th>
            <th class="text-right">Tokens In</th>
            <th class="text-right">Tokens Out</th>
            <th class="text-right">Cost</th>
            <th class="text-right">Duration</th>
            <th class="text-center">Status</th>
          </tr>
        </thead>
        <tbody id="runs-tbody"></tbody>
      </table>
    </div>
  </div>
</div>

<!-- Tab: Schedule -->
<div class="tab-content" id="tab-schedule">
  <iframe src="/calendar.html" class="schedule-iframe"></iframe>
</div>

<!-- Tab: Activity Log -->
<div class="tab-content" id="tab-log">
  <div class="section">
    <div class="activity-log" id="activity-log"></div>
  </div>
</div>

<!-- Tab: Docs -->
<div class="tab-content" id="tab-docs">
  <div class="section" style="max-width:800px;">

    <!-- Quickstart (hardcoded, always at top) -->
    <div class="doc-section">
      <div class="doc-header" onclick="toggleDocSection(this)">
        <h3>ğŸš€ Quickstart</h3>
        <span class="collapse-indicator">â–¼</span>
      </div>
      <div class="doc-content">
        <p><strong>What is this?</strong> OAS â€” OpenClaw Auto Sprint. A Kanban board where humans and agents coordinate tasks, routines, and reviews.</p>
        <p style="margin-top:8px;"><strong>Create a task:</strong> Click "+ New task" above the board. Fill in title, assignee, priority, description, due date.</p>
        <p style="margin-top:8px;"><strong>Edit a task:</strong> Use the action buttons on each card (â–¶ Start, âœ… Done, ğŸ‘€ Approve). Click on the priority to change it. Click on the assignee badge to reassign. Click on the date to change due date.</p>
        <p style="margin-top:8px;"><strong>Comments:</strong> Click "ğŸ’¬ comments" to open, write feedback and send.</p>
        <p style="margin-top:8px;"><strong>Search:</strong> Use the search bar to find content in memory files.</p>
      </div>
    </div>

    <!-- Dynamic docs sections will be loaded here -->
    <div id="dynamic-docs-container">
      <p class="loading-text" style="text-align:center;padding:20px;">Loading documentation...</p>
    </div>

  </div>
</div>

<!-- Tab: Brain -->
<div class="tab-content" id="tab-brain">
  <div class="section" style="max-width:900px;">
    <div id="brain-content" class="content-reader"></div>
  </div>
</div>

<!-- Tab: Ideas -->
<div class="tab-content" id="tab-ideas">
  <div class="section">
    <div class="filters-bar">
      <span class="filter-label">Filters:</span>
      <select id="filter-idea-status" onchange="applyIdeaFilters()">
        <option value="">All statuses</option>
        <option value="idea">ğŸ’¡ Idea</option>
        <option value="explorando">ğŸ”¬ Explorando</option>
        <option value="descartada">âŒ Descartada</option>
        <option value="promovida">ğŸ¯ Promovida</option>
      </select>
      <input type="text" id="filter-idea-tag" placeholder="Filter by tag" onkeyup="if(event.key==='Enter')applyIdeaFilters()" class="filter-tag-input">
      <button class="clear-filters" onclick="clearIdeaFilters()">Clear</button>
    </div>

    <details class="form-details">
      <summary>ğŸ’¡ Nueva idea</summary>
      <div class="add-form">
        <div class="form-row">
          <input type="text" id="idea-title" placeholder="TÃ­tulo de la idea">
          <input type="text" id="idea-source" placeholder="Fuente (link, persona, etc.)">
        </div>
        <div class="form-row">
          <textarea id="idea-context" placeholder="Contexto (2-3 lÃ­neas explicando la idea)" style="min-height: 60px;"></textarea>
        </div>
        <div class="form-row">
          <input type="text" id="idea-tags" placeholder="Tags (separados por comas: #ads, #mcp, #contenido)">
          <button class="btn-add" onclick="addIdea()">Crear Idea</button>
        </div>
      </div>
    </details>

    <div class="section-title">ğŸ’¡ Ideas & InspiraciÃ³n <span class="count" id="ideas-count"></span></div>
    <div class="cards" id="ideas-container">
      <!-- Ideas will be loaded here -->
    </div>
  </div>
</div>

<!-- Tab: Tools -->
<div class="tab-content" id="tab-tools">
  <div class="section" style="max-width:900px;">
    <div id="tools-content" class="content-reader"></div>
  </div>
</div>

<script src="https://cdn.jsdelivr.net/npm/marked/marked.min.js"></script>
<script src="/js/state.js"></script>
<script src="/js/utils.js"></script>
<script src="/js/api.js"></script>
<script src="/js/board.js"></script>
<script src="/js/app.js"></script>
</body>
</html>
